<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apsca-version" content="6695115aec738d9dda71f4110fdc1967b826de87">
    <title>Stories - APSCA</title>
    <style>
.topbar {
    position: sticky;
    top: 0;
    z-index: 20;
    background: rgba(255, 255, 255, 0.96);
    border-bottom: 1px solid var(--border-color);
    padding: 0.5rem 1.25rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.brand {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: 0.02em;
    text-decoration: none;
    overflow: hidden;
}

.brand-logo {
    width: 72px;
    height: 72px;
    min-width: 72px;
    max-width: 72px;
    min-height: 72px;
    max-height: 72px;
    aspect-ratio: 1;
    object-fit: contain;
}

.brand-name {
    font-size: 1.1rem;
}

.topbar-nav {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.35rem;
}

.topbar-nav a {
    padding: 0.4rem 0.6rem;
    border-radius: var(--radius-sm);
    font-size: 0.95rem;
    color: var(--text-secondary);
    border: 1px solid transparent;
    transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}

.topbar-nav a:hover,
.topbar-nav a.active {
    background: var(--accent-soft);
    color: var(--accent-color);
    border-color: rgba(37, 99, 235, 0.18);
}

:root {
    --bg-primary: #f3f4f6;
    --bg-secondary: #ffffff;
    --bg-muted: #eef2f6;
    --text-primary: #111827;
    --text-secondary: #4b5563;
    --text-muted: #9aa4b2;
    --border-color: #d7dee8;
    --accent-color: #2563eb;
    --accent-soft: rgba(37, 99, 235, 0.12);
    --success-color: #16a34a;
    --warning-color: #d97706;
    --danger-color: #dc2626;
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --shadow-xs: 0 1px 2px rgba(15, 23, 42, 0.04);
    --shadow-sm: 0 2px 6px rgba(15, 23, 42, 0.06);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.45;
    font-size: 20px;
}

a {
    color: var(--accent-color);
    text-decoration: none;
}

a:hover {
    text-decoration: none;
}

main {
    width: 100%;
    padding: 1rem 1.5rem 2rem;
}

h1 {
    font-size: 1.5rem;
    margin-bottom: 0.4rem;
    color: var(--text-primary);
    letter-spacing: -0.01em;
}

h2 {
    font-size: 1.1rem;
    margin: 1rem 0 0.5rem;
    color: var(--text-primary);
}

h3 {
    font-size: 0.95rem;
    margin: 0.75rem 0 0.4rem;
    color: var(--text-secondary);
    font-weight: 600;
}

p,
ul,
ol {
    margin-bottom: 0.6rem;
}

ul,
ol {
    padding-left: 1.2rem;
}

.muted {
    color: var(--text-secondary);
}

.meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem 0.9rem;
    color: var(--text-secondary);
    font-size: 0.82rem;
    margin-bottom: 0.8rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: 0.5rem 0.75rem;
    box-shadow: var(--shadow-xs);
}

.meta strong {
    color: var(--text-secondary);
    font-weight: 600;
}

.status-badge {
    display: inline-block;
    padding: 0.18rem 0.45rem;
    border-radius: 9999px;
    color: white;
    font-size: 0.62rem;
    font-weight: 600;
    text-transform: none;
    letter-spacing: 0.02em;
    box-shadow: none;
}

.page-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 0.5rem;
    flex-wrap: wrap;
}

.eyebrow {
    font-size: 0.68rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 0.2rem;
}

.page-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 0;
}

.page-actions {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
}

.button {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.65rem;
    border-radius: var(--radius-sm);
    font-size: 0.82rem;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-primary);
    text-decoration: none;
    box-shadow: var(--shadow-xs);
    transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
}

.button.primary {
    background: var(--accent-color);
    color: white;
    border-color: transparent;
}

.button:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: 0.75rem 0.9rem;
    margin-bottom: 0.75rem;
    box-shadow: var(--shadow-xs);
}

.card-link {
    text-decoration: none;
    color: inherit;
    transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
}

.card-link:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
    border-color: rgba(37, 99, 235, 0.2);
}

.quick-links {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.65rem;
}

.stat-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 0.65rem;
}

.stat-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: 0.75rem;
    box-shadow: var(--shadow-xs);
}

.stat-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-muted);
    margin-bottom: 0.35rem;
}

.stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
}

.index-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
    align-items: flex-end;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    padding: 0.6rem 0.75rem;
    margin: 0.75rem 0 1rem;
    box-shadow: var(--shadow-xs);
}

.toolbar-field {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    min-width: 160px;
    flex: 1 1 200px;
}

.toolbar-field label {
    font-size: 0.62rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-muted);
}

.toolbar-field input,
.toolbar-field select {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    padding: 0.4rem 0.6rem;
    font-size: 0.82rem;
    background: #ffffff;
    color: var(--text-primary);
}

.toolbar-meta {
    margin-left: auto;
    padding: 0.3rem 0.6rem;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    background: var(--bg-primary);
    font-size: 0.78rem;
    color: var(--text-secondary);
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.75rem 0;
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    overflow: hidden;
    box-shadow: var(--shadow-xs);
    border: 1px solid var(--border-color);
}

th,
td {
    text-align: left;
    padding: 0.45rem 0.6rem;
    border-bottom: 1px solid var(--border-color);
}

th {
    background: var(--bg-primary);
    font-weight: 600;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-secondary);
}

tbody tr:nth-child(even) {
    background: rgba(248, 250, 252, 0.6);
}

tbody tr:hover {
    background: rgba(226, 232, 240, 0.6);
}

td a {
    font-weight: 600;
}

tr:last-child td {
    border-bottom: none;
}

.index-table td {
    vertical-align: top;
}

.record-cell a {
    font-weight: 600;
    font-size: 0.9rem;
}

.cell-primary {
    font-size: 0.85rem;
    color: var(--text-primary);
    line-height: 1.35;
}

.cell-secondary {
    margin-top: 0.2rem;
    font-size: 0.74rem;
    color: var(--text-secondary);
    line-height: 1.3;
}

.summary-cell .cell-secondary {
    color: var(--text-muted);
}

.status-cell {
    white-space: nowrap;
}

.badge-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    align-items: center;
}

.tabs {
    margin: 0.75rem 0 1rem;
}

.tab-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.35rem;
}

.tab-button {
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-secondary);
    padding: 0.35rem 0.6rem;
    border-radius: var(--radius-sm);
    font-size: 0.8rem;
    cursor: pointer;
    transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}

.tab-button.active {
    background: var(--accent-soft);
    color: var(--accent-color);
    border-color: rgba(37, 99, 235, 0.2);
    font-weight: 600;
}

.tab-panel {
    display: none;
    margin-top: 0.6rem;
}

.tab-panel.active {
    display: block;
}

.connected-table {
    margin-top: 0.4rem;
}

.connected-summary {
    font-size: 0.82rem;
    color: var(--text-secondary);
    margin: 0.3rem 0 0.35rem;
}

.connected-summary a {
    font-weight: 600;
}

.empty-cell {
    text-align: center;
    color: var(--text-secondary);
    font-size: 0.82rem;
    padding: 0.8rem 0.6rem;
}

.section {
    margin: 1rem 0;
}

code {
    background: var(--bg-primary);
    padding: 0.15rem 0.35rem;
    border-radius: var(--radius-sm);
    font-size: 0.85em;
}

.version-select {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    padding: 0.3rem 0.55rem;
    font-size: 0.82rem;
    background: #ffffff;
    color: var(--text-primary);
}

.version-panel {
    display: none;
}

.version-panel.active {
    display: block;
}

.version-meta {
    font-size: 0.78rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
}

@media (max-width: 960px) {
    .topbar {
        padding: 0.5rem 0.75rem;
    }

    main {
        padding: 0.75rem 1rem 1.5rem;
    }
}

/* Stories Index Page Layout for Epic Drawer */
body:has(.stories-layout) {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

.stories-layout {
    display: grid;
    grid-template-columns: minmax(0, 1fr) 0;
    grid-template-rows: 1fr;
    --epic-drawer-width: 450px;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

.stories-layout.drawer-open {
    grid-template-columns: minmax(0, 1fr) var(--epic-drawer-width);
}

.stories-content {
    min-width: 0;
    padding: 1rem 1.5rem 2rem;
    overflow-y: auto;
}

/* Epic Drawer */
.epic-drawer {
    position: relative;
    width: 100%;
    height: 100%;
    background: var(--bg-secondary);
    border-left: 1px solid var(--border-color);
    box-shadow: -6px 0 16px rgba(15, 23, 42, 0.08);
    display: flex;
    flex-direction: column;
    opacity: 0;
    pointer-events: none;
    overflow: hidden;
}

.stories-layout.drawer-open .epic-drawer {
    opacity: 1;
    pointer-events: auto;
}

.epic-drawer-resize-handle {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 6px;
    cursor: ew-resize;
    background: transparent;
    z-index: 10;
    transition: background 0.15s ease;
    opacity: 0;
    pointer-events: none;
}

.stories-layout.drawer-open .epic-drawer-resize-handle {
    opacity: 1;
    pointer-events: auto;
}

.epic-drawer-resize-handle:hover,
.epic-drawer-resize-handle.resizing {
    background: var(--accent-color);
}

.epic-drawer-header {
    padding: 0.85rem 1rem 0.65rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
}

.epic-drawer-title {
    font-size: 0.9rem;
    font-weight: 600;
}

.epic-drawer-title a {
    color: var(--accent-color);
}

.epic-drawer-body {
    padding: 0.75rem 1rem 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    overflow-y: auto;
    flex: 1;
}

.epic-drawer-meta {
    font-size: 0.72rem;
    color: var(--text-muted);
}

.epic-drawer-section {
    margin-bottom: 0.6rem;
}

.epic-drawer-section-title {
    font-size: 0.62rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-muted);
    margin-bottom: 0.35rem;
    display: flex;
    align-items: center;
    gap: 0.4rem;
}

.epic-drawer-summary {
    font-size: 0.85rem;
    color: var(--text-primary);
    line-height: 1.4;
}

/* Stories table inside epic drawer */
.epic-stories-table-wrap {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    overflow: hidden;
    background: #ffffff;
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 120px;
}

.epic-stories-table-scroll {
    overflow: auto;
    flex: 1;
}

.epic-stories-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.78rem;
    table-layout: fixed;
}

.epic-stories-table th,
.epic-stories-table td {
    padding: 0.4rem 0.45rem;
    border-bottom: 1px solid var(--border-color);
    text-align: left;
    vertical-align: top;
}

.epic-stories-table th {
    background: var(--bg-muted);
    font-size: 0.6rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-secondary);
    position: sticky;
    top: 0;
}

.epic-stories-table tbody tr:last-child td {
    border-bottom: none;
}

.epic-stories-table .story-id {
    font-weight: 600;
    font-size: 0.78rem;
}

.epic-stories-table .story-id a {
    text-decoration: none;
    color: var(--accent-color);
}

.epic-stories-table .story-id a:hover {
    text-decoration: underline;
}

.epic-stories-table .story-title {
    font-size: 0.74rem;
    color: var(--text-secondary);
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.epic-stories-table .status-badge {
    display: inline-block;
    padding: 0.15rem 0.35rem;
    border-radius: 9999px;
    color: white;
    font-size: 0.58rem;
    font-weight: 600;
    text-transform: none;
    letter-spacing: 0.02em;
}

.epic-drawer-backdrop {
    display: none;
}

/* Epic column styling */
.epic-cell {
    white-space: nowrap;
}

.epic-cell-link {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.15rem 0.35rem;
    border-radius: var(--radius-sm);
    background: rgba(139, 92, 246, 0.1);
    border: 1px solid rgba(139, 92, 246, 0.2);
    font-size: 0.78rem;
    color: #7c3aed;
    cursor: pointer;
    transition: background 0.15s ease, border-color 0.15s ease;
}

.epic-cell-link:hover {
    background: rgba(139, 92, 246, 0.18);
    border-color: rgba(139, 92, 246, 0.35);
}

.epic-cell-none {
    color: var(--text-muted);
    font-size: 0.78rem;
    font-style: italic;
}

/* Multi-select dropdown for epic filter */
.epic-filter-dropdown {
    position: relative;
    min-width: 200px;
    flex: 1 1 220px;
}

.epic-filter-trigger {
    width: 100%;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    padding: 0.4rem 0.6rem;
    font-size: 0.82rem;
    background: #ffffff;
    color: var(--text-primary);
    cursor: pointer;
    text-align: left;
}

.epic-filter-menu {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    width: 100%;
    min-width: 280px;
    background: #ffffff;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow-sm);
    padding: 0.5rem;
    z-index: 30;
    display: none;
}

.epic-filter-dropdown.open .epic-filter-menu {
    display: block;
}

.epic-filter-search {
    width: 100%;
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    padding: 0.3rem 0.5rem;
    font-size: 0.8rem;
    margin-bottom: 0.4rem;
}

.epic-filter-list {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    background: #ffffff;
    max-height: 200px;
    overflow-y: auto;
    padding: 0.35rem 0.5rem;
}

.epic-filter-item {
    display: flex;
    align-items: flex-start;
    gap: 0.35rem;
    font-size: 0.78rem;
    color: var(--text-secondary);
    padding: 0.25rem 0.1rem;
    cursor: pointer;
}

.epic-filter-item:hover {
    background: var(--bg-muted);
}

.epic-filter-item input {
    margin-top: 2px;
}

/* Mobile responsiveness for epic drawer */
@media (max-width: 900px) {
    .stories-layout.drawer-open {
        grid-template-columns: 1fr;
    }

    .epic-drawer {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        width: min(85vw, 380px);
        max-width: 380px;
        z-index: 100;
        transform: translateX(100%);
        transition: transform 0.2s ease, opacity 0.2s ease;
    }

    .stories-layout.drawer-open .epic-drawer {
        transform: translateX(0);
    }

    .epic-drawer-resize-handle {
        display: none;
    }

    .epic-drawer-backdrop {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.4);
        z-index: 99;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease;
    }

    .stories-layout.drawer-open .epic-drawer-backdrop {
        opacity: 1;
        pointer-events: auto;
    }
}

/* Breadcrumb Navigation */
.breadcrumb-nav {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.5rem 0;
    margin-bottom: 0.5rem;
    font-size: 0.82rem;
    min-height: 1.5rem;
}

.breadcrumb-link {
    color: var(--accent-color);
    text-decoration: none;
}

.breadcrumb-link:hover {
    text-decoration: underline;
}

.breadcrumb-separator {
    color: var(--text-muted);
    font-size: 0.75rem;
    user-select: none;
}

.breadcrumb-ellipsis {
    color: var(--text-muted);
    font-size: 0.75rem;
}

.breadcrumb-current {
    color: var(--text-secondary);
}

/* Version Banner */
.version-banner {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: #fef3c7;
    border-bottom: 1px solid #f59e0b;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    font-size: 0.85rem;
    color: #92400e;
}

.version-banner.hidden {
    display: none;
}

.version-banner-text {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.version-banner-kbd {
    font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, monospace;
    font-size: 0.75rem;
    background: rgba(146, 64, 14, 0.1);
    padding: 0.15rem 0.35rem;
    border-radius: 3px;
    border: 1px solid rgba(146, 64, 14, 0.2);
}

.version-banner-refresh {
    background: #f59e0b;
    color: white;
    border: none;
    padding: 0.35rem 0.75rem;
    border-radius: var(--radius-sm);
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.15s ease;
}

.version-banner-refresh:hover {
    background: #d97706;
}

.version-banner-dismiss {
    background: transparent;
    border: none;
    color: #92400e;
    font-size: 1.1rem;
    cursor: pointer;
    padding: 0.25rem;
    line-height: 1;
    opacity: 0.7;
    transition: opacity 0.15s ease;
}

.version-banner-dismiss:hover {
    opacity: 1;
}

body.has-version-banner .topbar {
    top: 42px;
}

body.has-version-banner main {
    padding-top: 42px;
}
</style>
</head>
<body>
    <div id="version-banner" class="version-banner hidden" role="alert">
        <span class="version-banner-text">
            A newer version is available.
            <span>Or press <kbd class="version-banner-kbd">Ctrl+Shift+R</kbd></span>
        </span>
        <button class="version-banner-refresh" onclick="refreshWithDismiss()">Refresh Now</button>
        <button class="version-banner-dismiss" onclick="dismissVersionBanner()" aria-label="Dismiss">&times;</button>
    </div>
    
<header class="topbar">
    <a class="brand" href="../story-map.html?nav=1">
        <img class="brand-logo" src="../images/APSCA-logo.svg" alt="APSCA" width="36" height="36" />
        <span class="brand-name">APSCA Requirements Dashboard</span>
    </a>
    <nav class="topbar-nav" aria-label="Primary">
        <a href="../story-map.html?nav=1">Story Map</a> <a href="../features/index.html?nav=1">Features</a> <a href="../epics/index.html?nav=1">Epics</a> <a href="../stories/index.html?nav=1" class="active">Stories</a> <a href="../requirements/index.html?nav=1">Requirements</a> <a href="../artifacts/index.html?nav=1">Business Artifacts</a> <a href="../releases/index.html?nav=1">Releases</a> <a href="../definitions.html?nav=1">Definitions</a>
    </nav>
</header>

    <div class="stories-layout" id="stories-layout"><div class="stories-content"><nav id="breadcrumb-nav" class="breadcrumb-nav" aria-label="Breadcrumb"></nav><h1>Stories</h1>
<p class="page-subtitle">User-centered capabilities with acceptance criteria, derived from Epics and Requirements.</p>

<div class="index-toolbar">
    <div class="toolbar-field">
        <label for="search-input">Search</label>
        <input type="search" id="search-input" placeholder="Search by ID, title, status, release..." />
    </div>
    <div class="toolbar-field">
        <label for="status-filter">User Story Status</label>
        <select id="status-filter">
            <option value="all">All statuses</option>
            <option value="active">Active</option>
<option value="deprecated">Deprecated</option>
        </select>
    </div>
    
    <div class="toolbar-field epic-filter-dropdown" id="epic-filter-dropdown">
        <label>Epic</label>
        <button type="button" class="epic-filter-trigger" id="epic-filter-trigger" aria-expanded="false">All epics</button>
        <div class="epic-filter-menu" id="epic-filter-menu">
            <input type="search" class="epic-filter-search" id="epic-filter-search" placeholder="Filter epics..." />
            <div class="epic-filter-list" id="epic-filter-list">
                
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-001" />
                    <span><strong>EPIC-001</strong>: Exam Eligibility &amp; Invoice Generation</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-002" />
                    <span><strong>EPIC-002</strong>: Firm Bulk Exam Purchasing</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-003" />
                    <span><strong>EPIC-003</strong>: Exam Scheduling &amp; Integration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-004" />
                    <span><strong>EPIC-004</strong>: Cancellations, Rescheduling &amp; Fees</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-005" />
                    <span><strong>EPIC-005</strong>: Exam Change Requests (Firm-Initiated)</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-006" />
                    <span><strong>EPIC-006</strong>: Exam Launch &amp; Proctoring</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-007" />
                    <span><strong>EPIC-007</strong>: Exam Results &amp; Status Updates</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-008" />
                    <span><strong>EPIC-008</strong>: Exam Remediation Pathways</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-009" />
                    <span><strong>EPIC-009</strong>: Exam Template &amp; Configuration Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-010" />
                    <span><strong>EPIC-010</strong>: Admin Exam Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-011" />
                    <span><strong>EPIC-011</strong>: Enrollment &amp; Onboarding</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-012" />
                    <span><strong>EPIC-012</strong>: Employment Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-013" />
                    <span><strong>EPIC-013</strong>: Audit Log Submission</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-014" />
                    <span><strong>EPIC-014</strong>: Audit Log Verification</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-015" />
                    <span><strong>EPIC-015</strong>: Status Automation</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-016" />
                    <span><strong>EPIC-016</strong>: Level Progression</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-017" />
                    <span><strong>EPIC-017</strong>: Lapse &amp; Expiration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-018" />
                    <span><strong>EPIC-018</strong>: Status Restoration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-019" />
                    <span><strong>EPIC-019</strong>: CPD Submission &amp; Tracking</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-020" />
                    <span><strong>EPIC-020</strong>: Firm CPD Approval</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-021" />
                    <span><strong>EPIC-021</strong>: Training Course Recognition</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-022" />
                    <span><strong>EPIC-022</strong>: Annual CPD Compliance</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-023" />
                    <span><strong>EPIC-023</strong>: CPD Reporting</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-024" />
                    <span><strong>EPIC-024</strong>: Invoice Generation</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-025" />
                    <span><strong>EPIC-025</strong>: Payment Processing</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-026" />
                    <span><strong>EPIC-026</strong>: QuickBooks Integration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-027" />
                    <span><strong>EPIC-027</strong>: Firm Self-Invoicing</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-028" />
                    <span><strong>EPIC-028</strong>: Anomaly Detection</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-029" />
                    <span><strong>EPIC-029</strong>: Bulk Credits &amp; Drawdown</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-030" />
                    <span><strong>EPIC-030</strong>: Membership Fee Processing</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-031" />
                    <span><strong>EPIC-031</strong>: Authentication &amp; MFA</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-032" />
                    <span><strong>EPIC-032</strong>: Role-Based Access Control</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-033" />
                    <span><strong>EPIC-033</strong>: Multi-Role Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-034" />
                    <span><strong>EPIC-034</strong>: Role-Specific Redirects</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-035" />
                    <span><strong>EPIC-035</strong>: Profile Validation</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-036" />
                    <span><strong>EPIC-036</strong>: Firm Membership Status</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-037" />
                    <span><strong>EPIC-037</strong>: Individual Membership Status</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-038" />
                    <span><strong>EPIC-038</strong>: Member Categories</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-039" />
                    <span><strong>EPIC-039</strong>: Agreements &amp; Consent Tracking</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-040" />
                    <span><strong>EPIC-040</strong>: Annual Renewal Processing</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-041" />
                    <span><strong>EPIC-041</strong>: Firm Profile Updates</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-042" />
                    <span><strong>EPIC-042</strong>: Auditor Association Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-043" />
                    <span><strong>EPIC-043</strong>: Accreditation Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-044" />
                    <span><strong>EPIC-044</strong>: Geographic Coverage</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-045" />
                    <span><strong>EPIC-045</strong>: Embeddable Public Lists</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-046" />
                    <span><strong>EPIC-046</strong>: Real-Time Dashboards</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-047" />
                    <span><strong>EPIC-047</strong>: Geographic Visualizations</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-048" />
                    <span><strong>EPIC-048</strong>: Custom Report Builder</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-049" />
                    <span><strong>EPIC-049</strong>: Metabase Integration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-050" />
                    <span><strong>EPIC-050</strong>: Progress Tracking Visualizations</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-051" />
                    <span><strong>EPIC-051</strong>: Audit Trail &amp; Logging</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-052" />
                    <span><strong>EPIC-052</strong>: Data Encryption</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-053" />
                    <span><strong>EPIC-053</strong>: Data Retention &amp; Archiving</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-054" />
                    <span><strong>EPIC-054</strong>: Backup &amp; Recovery</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-055" />
                    <span><strong>EPIC-055</strong>: Incident Response</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-056" />
                    <span><strong>EPIC-056</strong>: Email Deliverability</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-057" />
                    <span><strong>EPIC-057</strong>: Partner Verification API</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-058" />
                    <span><strong>EPIC-058</strong>: LMS Integration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-059" />
                    <span><strong>EPIC-059</strong>: Public Register Embeds</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-060" />
                    <span><strong>EPIC-060</strong>: ZenDesk Integration</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-061" />
                    <span><strong>EPIC-061</strong>: Ethics Case Management</span>
                </label>
            
                <label class="epic-filter-item">
                    <input type="checkbox" value="EPIC-062" />
                    <span><strong>EPIC-062</strong>: Compliance Data Tracking</span>
                </label>
            
            </div>
        </div>
    </div>

    <div class="toolbar-meta" id="results-count"></div>
</div>
<script>
(function() {
    var statusFilter = document.getElementById('status-filter');
    if (statusFilter && 'active' !== 'all') {
        statusFilter.value = 'active';
    }
})();
</script>
<table class="index-table"><thead><tr><th>Record</th><th>Summary</th><th>Epic</th><th>Version</th><th>User Story Status</th><th>Version Status</th><th>Version Approval</th></tr></thead><tbody><tr data-filter-item="true" data-status="active" data-epic="EPIC-003" data-search-text="story-001 auditor schedules part 1 exam active rel-2026-06-01 as an auditor, i want to purchase and schedule my part 1 certification exam, so that i can begin my certification journey with a confirmed exam date. release: rel-2026-06-01 epic-003 exam scheduling &amp; integration"><td class="record-cell"><a href="STORY-001.html">STORY-001</a><div class="cell-secondary">Auditor Schedules Part 1 Exam</div></td><td class="summary-cell"><div class="cell-primary">As an auditor, I want to purchase and schedule my Part 1 certification exam, so that I can begin my certification journey with a confirmed exam date.</div><div class="cell-secondary">Release: REL-2026-06-01</div></td><td class="epic-cell"><button type="button" class="epic-cell-link" data-epic-id="EPIC-003" aria-label="View epic details">EPIC-003</button></td><td class="status-cell">v1</td><td class="status-cell"><span class="status-badge" style="background-color: #16a34a">Active</span></td><td class="status-cell"><span class="status-badge" style="background-color: #2563eb">Backlog</span></td><td class="status-cell"><span class="status-badge" style="background-color: #9ca3af">Pending Approval</span></td></tr><tr data-filter-item="true" data-status="active" data-epic="EPIC-002" data-search-text="story-002 firm purchases exams in bulk active rel-2026-06-01 as a firm supervisor, i want to select multiple auditors and purchase their exams in a single transaction, so that i can efficiently manage exam costs for my team without processing individual invoices. release: rel-2026-06-01 epic-002 firm bulk exam purchasing"><td class="record-cell"><a href="STORY-002.html">STORY-002</a><div class="cell-secondary">Firm Purchases Exams in Bulk</div></td><td class="summary-cell"><div class="cell-primary">As a firm supervisor, I want to select multiple auditors and purchase their exams in a single transaction, so that I can efficiently manage exam costs for my team without processing individual invoices.</div><div class="cell-secondary">Release: REL-2026-06-01</div></td><td class="epic-cell"><button type="button" class="epic-cell-link" data-epic-id="EPIC-002" aria-label="View epic details">EPIC-002</button></td><td class="status-cell">v1</td><td class="status-cell"><span class="status-badge" style="background-color: #16a34a">Active</span></td><td class="status-cell"><span class="status-badge" style="background-color: #2563eb">Backlog</span></td><td class="status-cell"><span class="status-badge" style="background-color: #9ca3af">Pending Approval</span></td></tr><tr data-filter-item="true" data-status="active" data-epic="EPIC-004" data-search-text="story-003 auditor reschedules exam active rel-2026-06-01 as an auditor, i want to reschedule my exam to a different date, so that i can accommodate a scheduling conflict without losing my exam fee. release: rel-2026-06-01 epic-004 cancellations, rescheduling &amp; fees"><td class="record-cell"><a href="STORY-003.html">STORY-003</a><div class="cell-secondary">Auditor Reschedules Exam</div></td><td class="summary-cell"><div class="cell-primary">As an auditor, I want to reschedule my exam to a different date, so that I can accommodate a scheduling conflict without losing my exam fee.</div><div class="cell-secondary">Release: REL-2026-06-01</div></td><td class="epic-cell"><button type="button" class="epic-cell-link" data-epic-id="EPIC-004" aria-label="View epic details">EPIC-004</button></td><td class="status-cell">v1</td><td class="status-cell"><span class="status-badge" style="background-color: #16a34a">Active</span></td><td class="status-cell"><span class="status-badge" style="background-color: #2563eb">Backlog</span></td><td class="status-cell"><span class="status-badge" style="background-color: #9ca3af">Pending Approval</span></td></tr><tr data-filter-item="true" data-status="active" data-epic="EPIC-006" data-search-text="story-004 auditor launches exam active rel-2026-06-01 as an auditor, i want to launch my proctored exam directly from my dashboard, so that i can access my exam session without manually logging into proctoru. release: rel-2026-06-01 epic-006 exam launch &amp; proctoring"><td class="record-cell"><a href="STORY-004.html">STORY-004</a><div class="cell-secondary">Auditor Launches Exam</div></td><td class="summary-cell"><div class="cell-primary">As an auditor, I want to launch my proctored exam directly from my dashboard, so that I can access my exam session without manually logging into ProctorU.</div><div class="cell-secondary">Release: REL-2026-06-01</div></td><td class="epic-cell"><button type="button" class="epic-cell-link" data-epic-id="EPIC-006" aria-label="View epic details">EPIC-006</button></td><td class="status-cell">v1</td><td class="status-cell"><span class="status-badge" style="background-color: #16a34a">Active</span></td><td class="status-cell"><span class="status-badge" style="background-color: #2563eb">Backlog</span></td><td class="status-cell"><span class="status-badge" style="background-color: #9ca3af">Pending Approval</span></td></tr><tr data-filter-item="true" data-status="active" data-epic="EPIC-010" data-search-text="story-005 admin overrides scheduling rules active rel-2026-06-01 as an apsca administrator, i want to schedule an exam on behalf of an auditor while bypassing the standard lead time requirement, so that i can resolve special circumstances without the auditor being blocked by system rules. release: rel-2026-06-01 epic-010 admin exam management"><td class="record-cell"><a href="STORY-005.html">STORY-005</a><div class="cell-secondary">Admin Overrides Scheduling Rules</div></td><td class="summary-cell"><div class="cell-primary">As an APSCA administrator, I want to schedule an exam on behalf of an auditor while bypassing the standard lead time requirement, so that I can resolve special circumstances without the auditor being blocked by system rules.</div><div class="cell-secondary">Release: REL-2026-06-01</div></td><td class="epic-cell"><button type="button" class="epic-cell-link" data-epic-id="EPIC-010" aria-label="View epic details">EPIC-010</button></td><td class="status-cell">v1</td><td class="status-cell"><span class="status-badge" style="background-color: #16a34a">Active</span></td><td class="status-cell"><span class="status-badge" style="background-color: #2563eb">Backlog</span></td><td class="status-cell"><span class="status-badge" style="background-color: #9ca3af">Pending Approval</span></td></tr></tbody></table></div>
<aside class="epic-drawer" id="epic-drawer" aria-hidden="true" aria-label="Epic details">
    <div class="epic-drawer-resize-handle" id="epic-drawer-resize-handle" aria-hidden="true"></div>
    <div class="epic-drawer-header">
        <div>
            <div class="epic-drawer-title" id="epic-drawer-title">Epic Details</div>
            <div class="epic-drawer-meta" id="epic-drawer-meta"></div>
        </div>
        <button class="button" id="epic-drawer-close" type="button">Close</button>
    </div>
    <div class="epic-drawer-body" id="epic-drawer-body">
        <p>Select an epic to view details.</p>
    </div>
</aside>
<div class="epic-drawer-backdrop" id="epic-drawer-backdrop"></div>
<script>
const epicData = {"EPIC-001": {"id": "EPIC-001", "title": "Exam Eligibility & Invoice Generation", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Logic to determine if an auditor can purchase a specific exam (Part 1, 2, or 3). Includes prerequisites (status, sequencing), generating the invoice line item, capturing exam language preferences, and enforcing invoice validity periods.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-001", "REQ-002", "REQ-003", "REQ-004", "REQ-005", "REQ-006", "REQ-007"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:19Z", "updated_at": "2026-01-20T07:13:19Z", "owner": "", "notes": ""}]}, "EPIC-002": {"id": "EPIC-002", "title": "Firm Bulk Exam Purchasing", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Workflow for Firm users to select multiple employed auditors, validate their eligibility in batch, and generate a single bulk invoice for multiple exams.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-008", "REQ-009", "REQ-010", "REQ-011", "REQ-012"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:21Z", "updated_at": "2026-01-20T07:13:21Z", "owner": "", "notes": ""}]}, "EPIC-003": {"id": "EPIC-003", "title": "Exam Scheduling & Integration", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "The API integration with ProctorU (for Part 1/2) and the hybrid Calendly-to-ProctorU flow (for Part 3). Includes enforcing lead times, mapping time zones, and creating/linking ProctorU accounts via API.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-013", "REQ-014", "REQ-015", "REQ-016", "REQ-017", "REQ-018", "REQ-019", "REQ-020", "REQ-021"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:22Z", "updated_at": "2026-01-20T07:13:22Z", "owner": "", "notes": ""}]}, "EPIC-004": {"id": "EPIC-004", "title": "Cancellations, Rescheduling & Fees", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Logic for auditor self-service exam changes. Includes enforcing fee windows, reschedule limits, and determining payer based on original invoice ownership.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-022", "REQ-023", "REQ-024", "REQ-025", "REQ-026", "REQ-027", "REQ-028"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:24Z", "updated_at": "2026-01-20T07:13:24Z", "owner": "", "notes": ""}]}, "EPIC-005": {"id": "EPIC-005", "title": "Exam Change Requests (Firm-Initiated)", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "A ticketing workflow for Firms to request changes for exams they funded. Includes logic to transfer credits, cancel exams without auditor consent, and manage disputes.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-029", "REQ-030", "REQ-031", "REQ-032", "REQ-033", "REQ-034"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:25Z", "updated_at": "2026-01-20T07:13:25Z", "owner": "", "notes": ""}]}, "EPIC-006": {"id": "EPIC-006", "title": "Exam Launch & Proctoring", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "The day-of workflow for exam delivery. Generating the unique launch link, managing status transitions, and providing backup access if the platform is inaccessible.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-035", "REQ-036", "REQ-037", "REQ-038"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:26Z", "updated_at": "2026-01-20T07:13:26Z", "owner": "", "notes": ""}]}, "EPIC-007": {"id": "EPIC-007", "title": "Exam Results & Status Updates", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Processing webhooks from ProctorU, mapping external statuses to APSCA statuses, and handling manual score entry.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-039", "REQ-040", "REQ-041", "REQ-042", "REQ-043", "REQ-044", "REQ-045", "REQ-046"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:28Z", "updated_at": "2026-01-20T07:13:28Z", "owner": "", "notes": ""}]}, "EPIC-008": {"id": "EPIC-008", "title": "Exam Remediation Pathways", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Automation of status changes and requirements based on failure counts. Enforces waiting periods and training/audit log redo requirements.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-047", "REQ-048", "REQ-049", "REQ-050", "REQ-051", "REQ-052", "REQ-053"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:29Z", "updated_at": "2026-01-20T07:13:29Z", "owner": "", "notes": ""}]}, "EPIC-009": {"id": "EPIC-009", "title": "Exam Template & Configuration Management", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Backend management of exam type definitions containing metadata required by the ProctorU API (duration, allowed resources, proctor notes) for each exam type and language variant.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-054", "REQ-055", "REQ-056", "REQ-057"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:30Z", "updated_at": "2026-01-20T07:13:30Z", "owner": "", "notes": ""}]}, "EPIC-010": {"id": "EPIC-010", "title": "Admin Exam Management", "feature_ref": "FEAT-001", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-06-01", "summary": "Administrative interface to view, schedule, reschedule, or force-cancel exams on behalf of auditors, including the ability to override standard business rules.", "assumptions": [], "constraints": [], "requirement_refs": ["REQ-058", "REQ-059", "REQ-060", "REQ-061", "REQ-062", "REQ-063"], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:13:32Z", "updated_at": "2026-01-20T07:13:32Z", "owner": "", "notes": ""}]}, "EPIC-011": {"id": "EPIC-011", "title": "Enrollment & Onboarding", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firm submits new auditor, admin review, member number assignment, login activation. Visibility rules during draft/pending states.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:18Z", "updated_at": "2026-01-20T07:52:18Z", "owner": "", "notes": ""}]}, "EPIC-012": {"id": "EPIC-012", "title": "Employment Management", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auditor-firm associations, active/inactive employments, visibility permissions, duplicate prevention, disassociation workflows.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:19Z", "updated_at": "2026-01-20T07:52:19Z", "owner": "", "notes": ""}]}, "EPIC-013": {"id": "EPIC-013", "title": "Audit Log Submission", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auditor submits individual audit activity records (dates, firm, country, standard). Progress tracking toward 20-day requirement. Date collision blocking, 5-year age limit, 10-day cap on second-party audits.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:20Z", "updated_at": "2026-01-20T07:52:20Z", "owner": "", "notes": ""}]}, "EPIC-014": {"id": "EPIC-014", "title": "Audit Log Verification", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firm supervisor approval workflow. Per-entry approve/reject. External delegate verification via unique links. Confidentiality masking for third-party audits.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:21Z", "updated_at": "2026-01-20T07:52:21Z", "owner": "", "notes": ""}]}, "EPIC-015": {"id": "EPIC-015", "title": "Status Automation", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Rules engine for automatic status transitions (e.g., unpaid fees -> lapsed, lapsed > 24 months -> expired). Daily/weekly cron jobs.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:22Z", "updated_at": "2026-01-20T07:52:22Z", "owner": "", "notes": ""}]}, "EPIC-016": {"id": "EPIC-016", "title": "Level Progression", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "ASCA to CSCA transition upon Part 3 pass. Level assignment, certificate generation, digital ID updates.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:24Z", "updated_at": "2026-01-20T07:52:24Z", "owner": "", "notes": ""}]}, "EPIC-017": {"id": "EPIC-017", "title": "Lapse & Expiration", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Logic for membership lapse triggers (unpaid invoices, unsigned FOA, CPD non-compliance). Expiration after extended lapse period.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:25Z", "updated_at": "2026-01-20T07:52:25Z", "owner": "", "notes": ""}]}, "EPIC-018": {"id": "EPIC-018", "title": "Status Restoration", "feature_ref": "FEAT-002", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Checklist-based restoration (pay fees, sign FOA, complete CPD). Automated status update upon checklist completion.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:26Z", "updated_at": "2026-01-20T07:52:26Z", "owner": "", "notes": ""}]}, "EPIC-019": {"id": "EPIC-019", "title": "CPD Submission & Tracking", "feature_ref": "FEAT-003", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auditors submit CPD records (course, hours, date). Progress visualization toward annual requirement.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:39Z", "updated_at": "2026-01-20T07:52:39Z", "owner": "", "notes": ""}]}, "EPIC-020": {"id": "EPIC-020", "title": "Firm CPD Approval", "feature_ref": "FEAT-003", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firm supervisors review and approve auditor CPD submissions.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:41Z", "updated_at": "2026-01-20T07:52:41Z", "owner": "", "notes": ""}]}, "EPIC-021": {"id": "EPIC-021", "title": "Training Course Recognition", "feature_ref": "FEAT-003", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firms submit courses for APSCA recognition. Admin review workflow. Public/private course designation. Badge generation upon approval.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:42Z", "updated_at": "2026-01-20T07:52:42Z", "owner": "", "notes": ""}]}, "EPIC-022": {"id": "EPIC-022", "title": "Annual CPD Compliance", "feature_ref": "FEAT-003", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Year-end compliance check. Status impacts (lapse trigger if non-compliant). CPD override for auditors who passed exams in current year.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:43Z", "updated_at": "2026-01-20T07:52:43Z", "owner": "", "notes": ""}]}, "EPIC-023": {"id": "EPIC-023", "title": "CPD Reporting", "feature_ref": "FEAT-003", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Dashboards showing compliance rates, submissions pending review, auditor progress.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:52:44Z", "updated_at": "2026-01-20T07:52:44Z", "owner": "", "notes": ""}]}, "EPIC-024": {"id": "EPIC-024", "title": "Invoice Generation", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Creation of invoices for exams, membership, cancellation fees, etc. Line item management.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:10Z", "updated_at": "2026-01-20T07:53:10Z", "owner": "", "notes": ""}]}, "EPIC-025": {"id": "EPIC-025", "title": "Payment Processing", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Stripe integration for credit card payments. Payment status tracking. Receipt generation.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:11Z", "updated_at": "2026-01-20T07:53:11Z", "owner": "", "notes": ""}]}, "EPIC-026": {"id": "EPIC-026", "title": "QuickBooks Integration", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Two-way sync of invoices, payments, and customer records with QuickBooks Online.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:12Z", "updated_at": "2026-01-20T07:53:12Z", "owner": "", "notes": ""}]}, "EPIC-027": {"id": "EPIC-027", "title": "Firm Self-Invoicing", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firms report monthly audit totals and auto-generate their own invoices based on per-audit fee.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:14Z", "updated_at": "2026-01-20T07:53:14Z", "owner": "", "notes": ""}]}, "EPIC-028": {"id": "EPIC-028", "title": "Anomaly Detection", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Flagging of unusual self-reported figures (e.g., significantly lower than historical average).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:15Z", "updated_at": "2026-01-20T07:53:15Z", "owner": "", "notes": ""}]}, "EPIC-029": {"id": "EPIC-029", "title": "Bulk Credits & Drawdown", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firms pay lump sums; individual auditor fees draw down from credit balance.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:16Z", "updated_at": "2026-01-20T07:53:16Z", "owner": "", "notes": ""}]}, "EPIC-030": {"id": "EPIC-030", "title": "Membership Fee Processing", "feature_ref": "FEAT-004", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Annual membership fee invoicing. Inactive member discounts. Fee waivers and adjustments.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:17Z", "updated_at": "2026-01-20T07:53:17Z", "owner": "", "notes": ""}]}, "EPIC-031": {"id": "EPIC-031", "title": "Authentication & MFA", "feature_ref": "FEAT-005", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Login flow, multi-factor authentication, password reset, session management.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:30Z", "updated_at": "2026-01-20T07:53:30Z", "owner": "", "notes": ""}]}, "EPIC-032": {"id": "EPIC-032", "title": "Role-Based Access Control", "feature_ref": "FEAT-005", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Role definitions (Auditor, Firm Contact, Firm Supervisor, Admin, etc.). Permission matrices.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:31Z", "updated_at": "2026-01-20T07:53:31Z", "owner": "", "notes": ""}]}, "EPIC-033": {"id": "EPIC-033", "title": "Multi-Role Management", "feature_ref": "FEAT-005", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Users with multiple roles (e.g., auditor who is also firm contact). Role toggle within platform.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:32Z", "updated_at": "2026-01-20T07:53:32Z", "owner": "", "notes": ""}]}, "EPIC-034": {"id": "EPIC-034", "title": "Role-Specific Redirects", "feature_ref": "FEAT-005", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Dashboard routing based on active role. Homepage assignment per role.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:33Z", "updated_at": "2026-01-20T07:53:33Z", "owner": "", "notes": ""}]}, "EPIC-035": {"id": "EPIC-035", "title": "Profile Validation", "feature_ref": "FEAT-005", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Required fields enforcement (e.g., country of residence before exam scheduling). Profile completeness checks.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:35Z", "updated_at": "2026-01-20T07:53:35Z", "owner": "", "notes": ""}]}, "EPIC-036": {"id": "EPIC-036", "title": "Firm Membership Status", "feature_ref": "FEAT-006", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Active, suspended, terminated states. Status change workflows.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:47Z", "updated_at": "2026-01-20T07:53:47Z", "owner": "", "notes": ""}]}, "EPIC-037": {"id": "EPIC-037", "title": "Individual Membership Status", "feature_ref": "FEAT-006", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auditor membership tiers and states (Provisional, Full, Lapsed, Expired).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:48Z", "updated_at": "2026-01-20T07:53:48Z", "owner": "", "notes": ""}]}, "EPIC-038": {"id": "EPIC-038", "title": "Member Categories", "feature_ref": "FEAT-006", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Firm categorization (A/B/C). Category assignment and change logic.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:49Z", "updated_at": "2026-01-20T07:53:49Z", "owner": "", "notes": ""}]}, "EPIC-039": {"id": "EPIC-039", "title": "Agreements & Consent Tracking", "feature_ref": "FEAT-006", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Form of Acceptance, Code of Conduct, Confidentiality Framework. Signature tracking, expiration, renewal.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:51Z", "updated_at": "2026-01-20T07:53:51Z", "owner": "", "notes": ""}]}, "EPIC-040": {"id": "EPIC-040", "title": "Annual Renewal Processing", "feature_ref": "FEAT-006", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Yearly renewal workflow. FOA signature requirement. Fee generation. Status updates.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:53:52Z", "updated_at": "2026-01-20T07:53:52Z", "owner": "", "notes": ""}]}, "EPIC-041": {"id": "EPIC-041", "title": "Firm Profile Updates", "feature_ref": "FEAT-007", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Self-service editing of firm details (logo, contact info, website, addresses).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:04Z", "updated_at": "2026-01-20T07:54:04Z", "owner": "", "notes": ""}]}, "EPIC-042": {"id": "EPIC-042", "title": "Auditor Association Management", "feature_ref": "FEAT-007", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "View associated auditors. Manage employment relationships. Access restrictions on PII for active/disassociated auditors.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:05Z", "updated_at": "2026-01-20T07:54:05Z", "owner": "", "notes": ""}]}, "EPIC-043": {"id": "EPIC-043", "title": "Accreditation Management", "feature_ref": "FEAT-007", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Programs/brands the firm is accredited for (SMETA, BSCI, Disney, etc.). Self-service updates.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:06Z", "updated_at": "2026-01-20T07:54:06Z", "owner": "", "notes": ""}]}, "EPIC-044": {"id": "EPIC-044", "title": "Geographic Coverage", "feature_ref": "FEAT-007", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Countries/regions where firm conducts audits. Self-service updates.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:08Z", "updated_at": "2026-01-20T07:54:08Z", "owner": "", "notes": ""}]}, "EPIC-045": {"id": "EPIC-045", "title": "Embeddable Public Lists", "feature_ref": "FEAT-007", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auto-updating HTML embeds for public website (member firm lists, accredited programs).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:09Z", "updated_at": "2026-01-20T07:54:09Z", "owner": "", "notes": ""}]}, "EPIC-046": {"id": "EPIC-046", "title": "Real-Time Dashboards", "feature_ref": "FEAT-008", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Live views of key metrics (auditor counts by level/region, exam pass rates, CPD compliance).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:20Z", "updated_at": "2026-01-20T07:54:20Z", "owner": "", "notes": ""}]}, "EPIC-047": {"id": "EPIC-047", "title": "Geographic Visualizations", "feature_ref": "FEAT-008", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Map-based displays of auditor capacity by country. Interactive filtering.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:22Z", "updated_at": "2026-01-20T07:54:22Z", "owner": "", "notes": ""}]}, "EPIC-048": {"id": "EPIC-048", "title": "Custom Report Builder", "feature_ref": "FEAT-008", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Admin ability to create ad-hoc reports from available data sets.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:23Z", "updated_at": "2026-01-20T07:54:23Z", "owner": "", "notes": ""}]}, "EPIC-049": {"id": "EPIC-049", "title": "Metabase Integration", "feature_ref": "FEAT-008", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Connection to Metabase for advanced analytics and visualization.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:24Z", "updated_at": "2026-01-20T07:54:24Z", "owner": "", "notes": ""}]}, "EPIC-050": {"id": "EPIC-050", "title": "Progress Tracking Visualizations", "feature_ref": "FEAT-008", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Visual progress bars for audit log, CPD, certification journey. Color-coded status indicators.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:26Z", "updated_at": "2026-01-20T07:54:26Z", "owner": "", "notes": ""}]}, "EPIC-051": {"id": "EPIC-051", "title": "Audit Trail & Logging", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Record of all status changes, data modifications, admin actions. Timestamp, user, before/after values.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:38Z", "updated_at": "2026-01-20T07:54:38Z", "owner": "", "notes": ""}]}, "EPIC-052": {"id": "EPIC-052", "title": "Data Encryption", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Encryption at rest and in transit. Key management.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:39Z", "updated_at": "2026-01-20T07:54:39Z", "owner": "", "notes": ""}]}, "EPIC-053": {"id": "EPIC-053", "title": "Data Retention & Archiving", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Retention policies by data category. Archival process. Secure deletion at end-of-life.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:41Z", "updated_at": "2026-01-20T07:54:41Z", "owner": "", "notes": ""}]}, "EPIC-054": {"id": "EPIC-054", "title": "Backup & Recovery", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Automated backups. Disaster recovery procedures. Restore testing.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:42Z", "updated_at": "2026-01-20T07:54:42Z", "owner": "", "notes": ""}]}, "EPIC-055": {"id": "EPIC-055", "title": "Incident Response", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Security monitoring. Failed login detection. Breach response procedures.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:43Z", "updated_at": "2026-01-20T07:54:43Z", "owner": "", "notes": ""}]}, "EPIC-056": {"id": "EPIC-056", "title": "Email Deliverability", "feature_ref": "FEAT-009", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "SendGrid authentication. CNAME/SPF/DKIM configuration. Spam filter avoidance.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:44Z", "updated_at": "2026-01-20T07:54:44Z", "owner": "", "notes": ""}]}, "EPIC-057": {"id": "EPIC-057", "title": "Partner Verification API", "feature_ref": "FEAT-010", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "REST API for partners (Sedex, BSCI) to verify auditor/firm status in real-time. Replaces manual CSV uploads.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:55Z", "updated_at": "2026-01-20T07:54:55Z", "owner": "", "notes": ""}]}, "EPIC-058": {"id": "EPIC-058", "title": "LMS Integration", "feature_ref": "FEAT-010", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Data exchange with Learning Management System for exam scheduling, CPD course completion, training records.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:56Z", "updated_at": "2026-01-20T07:54:56Z", "owner": "", "notes": ""}]}, "EPIC-059": {"id": "EPIC-059", "title": "Public Register Embeds", "feature_ref": "FEAT-010", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Auto-updating public website content (member firm list, recognized training courses, certified auditors).", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:58Z", "updated_at": "2026-01-20T07:54:58Z", "owner": "", "notes": ""}]}, "EPIC-060": {"id": "EPIC-060", "title": "ZenDesk Integration", "feature_ref": "FEAT-010", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "Knowledge base widget. Role-specific article display. Support ticket creation.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:54:59Z", "updated_at": "2026-01-20T07:54:59Z", "owner": "", "notes": ""}]}, "EPIC-061": {"id": "EPIC-061", "title": "Ethics Case Management", "feature_ref": "FEAT-011", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "TBD - requires dedicated discovery. Placeholder epic for ethics case management workflows.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:55:06Z", "updated_at": "2026-01-20T07:55:06Z", "owner": "", "notes": ""}]}, "EPIC-062": {"id": "EPIC-062", "title": "Compliance Data Tracking", "feature_ref": "FEAT-011", "versions": [{"version": 1, "status": "backlog", "approved": false, "release_ref": "REL-2026-12-01", "summary": "TBD - requires dedicated discovery. Placeholder epic for compliance data tracking workflows.", "assumptions": [], "constraints": [], "requirement_refs": [], "artifact_refs": [], "supersedes": null, "created_at": "2026-01-20T07:55:07Z", "updated_at": "2026-01-20T07:55:07Z", "owner": "", "notes": ""}]}};
const storiesData = [{"id": "STORY-001", "title": "Auditor Schedules Part 1 Exam", "epic_ref": "EPIC-003", "status": "backlog"}, {"id": "STORY-002", "title": "Firm Purchases Exams in Bulk", "epic_ref": "EPIC-002", "status": "backlog"}, {"id": "STORY-003", "title": "Auditor Reschedules Exam", "epic_ref": "EPIC-004", "status": "backlog"}, {"id": "STORY-004", "title": "Auditor Launches Exam", "epic_ref": "EPIC-006", "status": "backlog"}, {"id": "STORY-005", "title": "Admin Overrides Scheduling Rules", "epic_ref": "EPIC-010", "status": "backlog"}];
</script>
</div>
<script>
(() => {
    const searchInput = document.getElementById('search-input');
    const statusFilter = document.getElementById('status-filter');
    const epicDropdown = document.getElementById('epic-filter-dropdown');
    const epicTrigger = document.getElementById('epic-filter-trigger');
    const epicMenu = document.getElementById('epic-filter-menu');
    const epicSearch = document.getElementById('epic-filter-search');
    const epicList = document.getElementById('epic-filter-list');
    const items = Array.from(document.querySelectorAll('[data-filter-item]'));
    const countEl = document.getElementById('results-count');
    const storiesLayout = document.getElementById('stories-layout');
    const epicDrawer = document.getElementById('epic-drawer');
    const epicDrawerClose = document.getElementById('epic-drawer-close');
    const epicDrawerBackdrop = document.getElementById('epic-drawer-backdrop');
    const epicDrawerTitle = document.getElementById('epic-drawer-title');
    const epicDrawerMeta = document.getElementById('epic-drawer-meta');
    const epicDrawerBody = document.getElementById('epic-drawer-body');
    const resizeHandle = document.getElementById('epic-drawer-resize-handle');

    if (!searchInput || !statusFilter || !countEl) return;

    // Get selected epics from checkboxes
    function getSelectedEpics() {
        if (!epicList) return [];
        return Array.from(epicList.querySelectorAll('input[type="checkbox"]:checked')).map(input => input.value);
    }

    // Update trigger text
    function updateEpicTrigger() {
        if (!epicTrigger) return;
        const selected = getSelectedEpics();
        if (selected.length === 0) {
            epicTrigger.textContent = 'All epics';
        } else if (selected.length === 1) {
            epicTrigger.textContent = selected[0];
        } else {
            epicTrigger.textContent = `${selected.length} epics selected`;
        }
    }

    // Filter epic list items
    function filterEpicList(term) {
        if (!epicList) return;
        const normalized = (term || '').toLowerCase();
        Array.from(epicList.querySelectorAll('label')).forEach(item => {
            const text = item.textContent.toLowerCase();
            item.style.display = !normalized || text.includes(normalized) ? '' : 'none';
        });
    }

    function applyFilters() {
        const term = searchInput.value.trim().toLowerCase();
        const status = statusFilter.value.toLowerCase();
        const selectedEpics = new Set(getSelectedEpics());
        const filterByEpic = selectedEpics.size > 0;

        let visible = 0;
        items.forEach((item) => {
            const text = (item.dataset.searchText || '').toLowerCase();
            const itemStatus = (item.dataset.status || '').toLowerCase();
            const itemEpic = item.dataset.epic || '';

            const matchesTerm = !term || text.includes(term);
            const matchesStatus = status === 'all' || itemStatus === status;
            const matchesEpic = !filterByEpic || selectedEpics.has(itemEpic);

            const show = matchesTerm && matchesStatus && matchesEpic;
            item.style.display = show ? '' : 'none';
            if (show) visible += 1;
        });
        countEl.textContent = `${visible} of ${items.length} shown`;
        updateEpicTrigger();
    }

    // Epic dropdown toggle
    if (epicTrigger && epicDropdown) {
        epicTrigger.addEventListener('click', () => {
            const isOpen = epicDropdown.classList.contains('open');
            if (isOpen) {
                epicDropdown.classList.remove('open');
                epicTrigger.setAttribute('aria-expanded', 'false');
            } else {
                epicDropdown.classList.add('open');
                epicTrigger.setAttribute('aria-expanded', 'true');
                if (epicSearch) epicSearch.focus();
            }
        });

        // Close on outside click
        document.addEventListener('click', (event) => {
            if (!epicDropdown.contains(event.target)) {
                epicDropdown.classList.remove('open');
                epicTrigger.setAttribute('aria-expanded', 'false');
            }
        });

        // Close on Escape
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && epicDropdown.classList.contains('open')) {
                epicDropdown.classList.remove('open');
                epicTrigger.setAttribute('aria-expanded', 'false');
            }
        });
    }

    // Epic filter search
    if (epicSearch) {
        epicSearch.addEventListener('input', () => {
            filterEpicList(epicSearch.value);
        });
    }

    // Epic filter checkbox changes
    if (epicList) {
        epicList.addEventListener('change', (event) => {
            if (event.target && event.target.matches('input[type="checkbox"]')) {
                applyFilters();
            }
        });
    }

    // Epic drawer functions
    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function getCurrentVersion(versions) {
        if (!versions || versions.length === 0) return null;
        // Look for backlog version first (active work version)
        const backlog = versions.filter(v => v.status === 'backlog');
        if (backlog.length > 0) {
            return backlog.reduce((a, b) => (a.version > b.version ? a : b));
        }
        // Fall back to highest version number
        return versions.reduce((a, b) => (a.version > b.version ? a : b));
    }

    function getStatusColor(status) {
        const colors = {
            // Release statuses
            'planned': '#64748b',
            'released': '#16a34a',
            // Artifact lifecycle
            'active': '#16a34a',
            'deprecated': '#dc2626',
            'draft': '#94a3b8',
            'provisional': '#f59e0b',
            // Version statuses
            'backlog': '#2563eb',
            'discarded': '#9ca3af'
        };
        return colors[status] || '#9aa4b2';
    }

    function formatStatus(status) {
        return (status || 'unknown').replace(/_/g, ' ');
    }

    function getConnectedStories(epicId) {
        if (typeof storiesData === 'undefined') return [];
        return storiesData.filter(s => s.epic_ref === epicId);
    }

    function openEpicDrawer(epicId) {
        if (!storiesLayout || !epicDrawer || typeof epicData === 'undefined') return;
        const epic = epicData[epicId];
        if (!epic) return;

        const currentVersion = getCurrentVersion(epic.versions);

        // Update drawer title with link
        epicDrawerTitle.innerHTML = `<a href="../epics/${escapeHtml(epic.id)}.html">${escapeHtml(epic.id)}</a>: ${escapeHtml(epic.title)}`;

        // Update meta info
        if (epic.feature_ref) {
            epicDrawerMeta.innerHTML = `Feature: <a href="../features/${escapeHtml(epic.feature_ref)}.html">${escapeHtml(epic.feature_ref)}</a>`;
        } else {
            epicDrawerMeta.textContent = '';
        }

        // Build body content
        let bodyHtml = '';
        if (currentVersion) {
            const versionBadge = `<span class="status-badge" style="background-color: #2563eb">v${currentVersion.version}</span>`;
            bodyHtml += `
                <div class="epic-drawer-section">
                    <div class="epic-drawer-section-title">Current Version ${versionBadge}</div>
                    <div class="epic-drawer-summary">${escapeHtml(currentVersion.summary || 'No summary')}</div>
                </div>
            `;

            if (currentVersion.release_ref) {
                bodyHtml += `
                    <div class="epic-drawer-section">
                        <div class="epic-drawer-section-title">Release</div>
                        <div><a href="../releases/${escapeHtml(currentVersion.release_ref)}.html">${escapeHtml(currentVersion.release_ref)}</a></div>
                    </div>
                `;
            }

            if (currentVersion.assumptions && currentVersion.assumptions.length > 0) {
                bodyHtml += `
                    <div class="epic-drawer-section">
                        <div class="epic-drawer-section-title">Assumptions</div>
                        <ul>${currentVersion.assumptions.map(a => `<li>${escapeHtml(a)}</li>`).join('')}</ul>
                    </div>
                `;
            }

            if (currentVersion.constraints && currentVersion.constraints.length > 0) {
                bodyHtml += `
                    <div class="epic-drawer-section">
                        <div class="epic-drawer-section-title">Constraints</div>
                        <ul>${currentVersion.constraints.map(c => `<li>${escapeHtml(c)}</li>`).join('')}</ul>
                    </div>
                `;
            }
        } else {
            bodyHtml = '<p>No version information available.</p>';
        }

        // Add connected stories table
        const connectedStories = getConnectedStories(epicId);
        bodyHtml += `
            <div class="epic-drawer-section" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                <div class="epic-drawer-section-title">Connected Stories (${connectedStories.length})</div>
                <div class="epic-stories-table-wrap">
                    <div class="epic-stories-table-scroll">
                        <table class="epic-stories-table">
                            <colgroup>
                                <col style="width: 25%;">
                                <col style="width: 50%;">
                                <col style="width: 25%;">
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Record</th>
                                    <th>Summary</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${connectedStories.length > 0 ? connectedStories.map(s => `
                                    <tr>
                                        <td class="story-id"><a href="./${escapeHtml(s.id)}.html">${escapeHtml(s.id)}</a></td>
                                        <td class="story-title">${escapeHtml(s.title)}</td>
                                        <td><span class="status-badge" style="background-color: ${getStatusColor(s.status)}">${formatStatus(s.status)}</span></td>
                                    </tr>
                                `).join('') : '<tr><td colspan="3" style="text-align: center; color: var(--text-muted); font-style: italic;">No stories in this epic</td></tr>'}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        `;

        bodyHtml += `
            <div class="epic-drawer-section" style="padding-top: 0.5rem; border-top: 1px solid var(--border-color);">
                <a href="../epics/${escapeHtml(epic.id)}.html" class="button primary">View Full Epic</a>
            </div>
        `;

        epicDrawerBody.innerHTML = bodyHtml;

        currentOpenEpicId = epicId;
        storiesLayout.classList.add('drawer-open');
        epicDrawer.setAttribute('aria-hidden', 'false');
    }

    // Track currently open epic
    let currentOpenEpicId = null;

    function closeEpicDrawer() {
        if (!storiesLayout || !epicDrawer) return;
        currentOpenEpicId = null;
        storiesLayout.classList.remove('drawer-open');
        epicDrawer.setAttribute('aria-hidden', 'true');
    }

    function isDrawerOpen() {
        return storiesLayout && storiesLayout.classList.contains('drawer-open');
    }

    // Epic cell click handlers
    document.querySelectorAll('.epic-cell-link').forEach(link => {
        link.addEventListener('click', (event) => {
            event.preventDefault();
            const epicId = link.dataset.epicId;
            if (!epicId) return;

            if (isDrawerOpen() && currentOpenEpicId === epicId) {
                // Clicking the same epic that's open - close the drawer
                closeEpicDrawer();
            } else {
                // Clicking a different epic or drawer is closed - open/switch to this epic
                openEpicDrawer(epicId);
            }
        });
    });

    // Close button
    if (epicDrawerClose) {
        epicDrawerClose.addEventListener('click', closeEpicDrawer);
    }

    // Backdrop click
    if (epicDrawerBackdrop) {
        epicDrawerBackdrop.addEventListener('click', closeEpicDrawer);
    }

    // Escape key for drawer
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && storiesLayout && storiesLayout.classList.contains('drawer-open')) {
            closeEpicDrawer();
        }
    });

    // Resize handle
    if (resizeHandle && storiesLayout) {
        let isResizing = false;
        let startX = 0;
        let startWidth = 450;

        function startResize(e) {
            if (window.innerWidth <= 900) return;
            e.stopPropagation();
            e.preventDefault();
            isResizing = true;
            startX = e.clientX || (e.touches && e.touches[0] ? e.touches[0].clientX : 0);
            startWidth = parseInt(getComputedStyle(storiesLayout).getPropertyValue('--epic-drawer-width')) || 450;
            resizeHandle.classList.add('resizing');
            document.body.style.cursor = 'ew-resize';
            document.body.style.userSelect = 'none';
            document.body.style.pointerEvents = 'none';
            resizeHandle.style.pointerEvents = 'auto';
        }

        function doResize(e) {
            if (!isResizing) return;
            e.stopPropagation();
            e.preventDefault();
            const currentX = e.clientX || (e.touches && e.touches[0] ? e.touches[0].clientX : 0);
            const diff = startX - currentX;
            const minWidth = 300;
            const maxWidth = Math.max(600, Math.floor(window.innerWidth * 0.5));
            const newWidth = Math.max(minWidth, Math.min(maxWidth, startWidth + diff));
            storiesLayout.style.setProperty('--epic-drawer-width', `${newWidth}px`);
        }

        function stopResize(e) {
            if (!isResizing) return;
            e.stopPropagation();
            isResizing = false;
            resizeHandle.classList.remove('resizing');
            document.body.style.cursor = '';
            document.body.style.userSelect = '';
            document.body.style.pointerEvents = '';
            resizeHandle.style.pointerEvents = '';
        }

        resizeHandle.addEventListener('mousedown', startResize);
        resizeHandle.addEventListener('touchstart', startResize, { passive: false });
        window.addEventListener('mousemove', doResize, { passive: false });
        window.addEventListener('touchmove', doResize, { passive: false });
        window.addEventListener('mouseup', stopResize);
        window.addEventListener('touchend', stopResize);
        window.addEventListener('mouseleave', stopResize);
    }

    searchInput.addEventListener('input', applyFilters);
    statusFilter.addEventListener('change', applyFilters);
    applyFilters();
})();
</script>

    <script>
    (() => {
        function initTabs() {
            const groups = document.querySelectorAll('[data-tab-group]');
            groups.forEach((group) => {
                const buttons = Array.from(group.querySelectorAll('.tab-button'));
                const panels = Array.from(group.querySelectorAll('[data-tab-panel]'));
                if (buttons.length === 0 || panels.length === 0) return;

                function setActive(button) {
                    const targetId = button.dataset.tabTarget;
                    const targetPanel = group.querySelector(`#${CSS.escape(targetId)}`);
                    buttons.forEach((btn) => {
                        btn.classList.remove('active');
                        btn.setAttribute('aria-selected', 'false');
                    });
                    panels.forEach((panel) => panel.classList.remove('active'));
                    button.classList.add('active');
                    button.setAttribute('aria-selected', 'true');
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                    }
                }

                buttons.forEach((button) => {
                    button.addEventListener('click', () => setActive(button));
                });

                const defaultButton = buttons.find(btn => btn.classList.contains('active')) || buttons[0];
                setActive(defaultButton);
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initTabs);
        } else {
            initTabs();
        }
    })();

    // Breadcrumb Navigation
    const BreadcrumbNav = (() => {
        const STORAGE_KEY = 'apsca_nav_history';
        const MAX_HISTORY = 10;
        const TRUNCATE_DISPLAY = 5;

        function getHistory() {
            try {
                const data = sessionStorage.getItem(STORAGE_KEY);
                return data ? JSON.parse(data) : [];
            } catch (e) { return []; }
        }

        function saveHistory(history) {
            sessionStorage.setItem(STORAGE_KEY, JSON.stringify(history.slice(-MAX_HISTORY)));
        }

        function getCurrentPageInfo() {
            const path = window.location.pathname;
            const parts = path.split('/').filter(Boolean);
            const filename = parts.pop() || 'index.html';
            const lastDir = parts.pop() || '';

            const knownSections = ['features', 'epics', 'stories', 'requirements', 'artifacts', 'releases'];
            const dir = knownSections.includes(lastDir) ? lastDir : '';

            const sectionLabels = {
                'features': 'Features', 'epics': 'Epics', 'stories': 'Stories',
                'requirements': 'Requirements', 'artifacts': 'Business Artifacts', 'releases': 'Releases'
            };

            let label;
            if (filename === 'index.html') {
                label = sectionLabels[dir] || 'Home';
            } else if (filename === 'story-map.html') {
                label = 'Story Map';
            } else {
                label = filename.replace('.html', '');
            }

            const url = dir ? dir + '/' + filename : filename;
            return { url, label, timestamp: Date.now() };
        }

        function updateHistoryOnLoad() {
            const params = new URLSearchParams(window.location.search);
            const isNavClick = params.has('nav');

            if (isNavClick) {
                params.delete('nav');
                const newUrl = window.location.pathname + (params.toString() ? '?' + params.toString() : '');
                window.history.replaceState(null, '', newUrl);
                sessionStorage.removeItem(STORAGE_KEY);
            }

            const history = isNavClick ? [] : getHistory();
            const currentPage = getCurrentPageInfo();
            const existingIndex = history.findIndex(e => e.url === currentPage.url);

            if (existingIndex !== -1) {
                const truncated = history.slice(0, existingIndex + 1);
                truncated[truncated.length - 1].timestamp = Date.now();
                saveHistory(truncated);
            } else {
                history.push(currentPage);
                saveHistory(history);
            }
        }

        function getRelativePath(fromUrl, toUrl) {
            const fromParts = fromUrl.split('/');
            const toParts = toUrl.split('/');
            fromParts.pop();
            const toFile = toParts.pop();
            const fromDir = fromParts.join('/');
            const toDir = toParts.join('/');
            if (fromDir === toDir) {
                return toFile;
            }
            const upLevels = fromParts.length;
            return '../'.repeat(upLevels) + toUrl;
        }

        function renderBreadcrumbs() {
            const history = getHistory();
            const container = document.getElementById('breadcrumb-nav');
            if (!container || history.length <= 1) {
                if (container) container.style.display = 'none';
                return;
            }

            const currentPage = history[history.length - 1];
            const previousPages = history.slice(0, -1);
            let display = previousPages;
            let showEllipsis = false;

            if (previousPages.length > TRUNCATE_DISPLAY) {
                display = previousPages.slice(-TRUNCATE_DISPLAY);
                showEllipsis = true;
            }

            let html = showEllipsis ? '<span class="breadcrumb-ellipsis">...</span><span class="breadcrumb-separator"></span>' : '';

            display.forEach((entry, idx) => {
                if (idx > 0) html += '<span class="breadcrumb-separator"></span>';
                const href = getRelativePath(currentPage.url, entry.url);
                html += '<a href="' + href + '" class="breadcrumb-link">' + entry.label + '</a>';
            });

            if (display.length > 0) {
                html += '<span class="breadcrumb-separator"></span>';
            }
            html += '<span class="breadcrumb-current">' + currentPage.label + '</span>';

            container.innerHTML = html;
            container.style.display = '';
        }

        function init() {
            updateHistoryOnLoad();
            renderBreadcrumbs();
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        return { init };
    })();

    // Version Check
    const VersionCheck = (() => {
        const DISMISSED_KEY = 'apsca_version_dismissed';
        const VERSION_URL = '../version.json';
        const DEBUG_PREFIX = '[VersionCheck]';

        function log(...args) {
            console.debug(DEBUG_PREFIX, ...args);
        }

        function getPageVersion() {
            const meta = document.querySelector('meta[name="apsca-version"]');
            return meta ? meta.getAttribute('content') : '';
        }

        function getDismissedVersion() {
            try {
                return localStorage.getItem(DISMISSED_KEY) || '';
            } catch (e) { return ''; }
        }

        function setDismissedVersion(version) {
            try {
                localStorage.setItem(DISMISSED_KEY, version);
                log('Stored dismissed version:', version.substring(0, 7));
            } catch (e) {
                log('Failed to store dismissed version:', e);
            }
        }

        function showBanner() {
            const banner = document.getElementById('version-banner');
            if (banner) {
                banner.classList.remove('hidden');
                document.body.classList.add('has-version-banner');
                log('Banner shown');
                // Update keyboard shortcut for Mac
                if (navigator.platform.indexOf('Mac') !== -1) {
                    const kbd = banner.querySelector('.version-banner-kbd');
                    if (kbd) kbd.textContent = 'Cmd+Shift+R';
                }
            }
        }

        async function checkVersion() {
            const pageVersion = getPageVersion();
            log('Check started - Page version:', pageVersion ? pageVersion.substring(0, 7) : '(none)');

            if (!pageVersion) {
                log('No page version found, skipping check');
                return;
            }

            try {
                const response = await fetch(VERSION_URL + '?t=' + Date.now());
                if (!response.ok) {
                    log('Fetch failed with status:', response.status);
                    return;
                }
                const data = await response.json();
                const serverVersion = data.commit || '';
                const dismissed = getDismissedVersion();

                log('Server version:', serverVersion ? serverVersion.substring(0, 7) : '(none)');
                log('Dismissed version:', dismissed ? dismissed.substring(0, 7) : '(none)');

                if (serverVersion && serverVersion !== pageVersion) {
                    log('Version mismatch detected');
                    if (dismissed !== serverVersion) {
                        log('Server version not dismissed, showing banner');
                        showBanner();
                    } else {
                        log('Server version already dismissed, hiding banner');
                    }
                } else {
                    log('Versions match, no banner needed');
                }
            } catch (e) {
                log('Check failed:', e.message || e);
            }
        }

        // Global function for dismiss button
        window.dismissVersionBanner = function() {
            log('Dismiss button clicked');
            const banner = document.getElementById('version-banner');
            if (banner) {
                banner.classList.add('hidden');
                document.body.classList.remove('has-version-banner');
            }
            // Get server version to store as dismissed
            fetch(VERSION_URL + '?t=' + Date.now())
                .then(r => r.json())
                .then(data => {
                    if (data.commit) {
                        log('Dismissing version:', data.commit.substring(0, 7));
                        setDismissedVersion(data.commit);
                    }
                })
                .catch((e) => {
                    log('Failed to fetch version for dismiss:', e);
                });
        };

        // Global function for refresh button - dismiss then refresh
        window.refreshWithDismiss = async function() {
            log('Refresh button clicked');
            try {
                // Fetch server version and store as dismissed before refreshing
                const response = await fetch(VERSION_URL + '?t=' + Date.now());
                if (response.ok) {
                    const data = await response.json();
                    if (data.commit) {
                        log('Dismissing version before refresh:', data.commit.substring(0, 7));
                        setDismissedVersion(data.commit);
                    }
                }
            } catch (e) {
                log('Failed to dismiss before refresh:', e);
            }
            log('Refreshing page...');
            // Refresh with cache-busting query param
            location.href = location.pathname + '?refresh=' + Date.now();
        };

        // Run check after page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkVersion);
        } else {
            checkVersion();
        }

        return { checkVersion };
    })();
    </script>
</body>
</html>
